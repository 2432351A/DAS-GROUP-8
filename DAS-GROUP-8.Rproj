Version: 1.0

RestoreWorkspace: Default
SaveWorkspace: Default
AlwaysSaveHistory: Default

EnableCodeIndexing: Yes
UseSpacesForTab: Yes
NumSpacesForTab: 2
Encoding: UTF-8

RnwWeave: Sweave
LaTeX: pdfLaTeX


data cleaning 
# import
library(tidyverse) 

# read data
mov <- read_csv("C:/Users/admin/Desktop/dataset08.csv")

# basic instructure
str(mov)
summary(mov)

# solve NA (delete the NA rows)
mov_1 <- na.omit(mov)

# 1. data summary
summary(mov_2)

# 2. univariate analysis
# histogram
ggplot(mov_2, aes(x=rating)) + 
  geom_histogram(binwidth=0.5, fill="blue", color="black") +
  labs(title="Rating Distribution", x="IMDB Rating", y="Count")

# boxplot - budget
ggplot(mov_2, aes(y=budget)) + 
  geom_boxplot(fill="tomato") +
  labs(title="Budget Boxplot", y="Budget (in $10M)")

# bar chart - genre
ggplot(mov_2, aes(x=genre)) + 
  geom_bar(fill="lightgreen") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) + # Rotating x-axis labels
  labs(title="Movie Genre Frequency", x="Genre", y="Count")

# 3. bivariate analysis
# Scatterplot - Budget & rating
ggplot(mov_2, aes(x=budget, y=rating)) +
  geom_point(aes(color=genre), alpha=0.5) + 
  scale_color_brewer(palette="Set1") +
  labs(title="Budget vs. Rating by Genre", x="Budget", y="IMDB Rating")

# Correlation coefficient matrix
numerical_mov_2 <- mov_2 %>% select(budget, rating, votes, length) 
cor_matrix <- cor(numerical_mov_2, use="complete.obs") 
corrplot(cor_matrix, method="circle") 

# 4. multivariate analysis
pairs(~budget+rating+votes+length, data=mov_2)
mov_2$genre <- as.factor(mov_2$genre)
colors <- rainbow(length(levels(mov_2$genre)))
genre_colors <- colors[as.numeric(mov_2$genre)]
pairs(~budget+rating+votes+length, data=mov_2, col=genre_colors)

# 5. hypothesis analysis
# We want to test whether there is a significant difference in film ratings across genres
library(stats)
kruskal.test(rating ~ genre, data=mov_2) # Kruskal-Wallis test












